(()=>{const t=document.getElementById("sortTabs"),e=document.getElementById("groupTabs"),r=document.getElementById("ungroupTabs"),n={currentWindow:!0,pinned:!1,url:["http://*/*","https://*/*"],groupId:chrome.tabGroups.TAB_GROUP_ID_NONE},o=["grey","yellow","green","cyan","blue","purple","pink","red"];function s(t){return function(t){return t.sort(((t,e)=>{const r=u(t.url.toLowerCase()),n=u(e.url.toLowerCase());return r<n?-1:r>n?1:0})),t}(function(t){return t.sort(((t,e)=>{const r=t.url.toLowerCase(),n=e.url.toLowerCase();return r<n?-1:r>n?1:0})),t}(t))}function u(t){let e="";if(""===t)return e;const r=t.match(/https?:\/\/(.*)$/);if(null===r||void 0===r[1]||""===r[1])return e;e=r[1];const n=e.indexOf("/");n>0&&(e=e.substr(0,n));const o=e.lastIndexOf(".");return o>0&&(e=e.substr(0,o)),e=e.replace(/^www\d?\./i,""),e}t.addEventListener("click",(async()=>{!function(t){for(let e=0;e<t.length;e++)chrome.tabs.move(t[e].id,{index:e})}(s(await chrome.tabs.query(n)))})),e.addEventListener("click",(async()=>{const t=s(await chrome.tabs.query(n)),[e]=await chrome.tabs.query({currentWindow:!0,active:!0}),r={},c=Array();for(let e=0;e<t.length;e++){const n=u(t[e].url);""!==n&&(void 0===r[n]&&(r[n]=Array(),c.push(n)),r[n].push(t[e].id))}c.sort();for(let t in c){const n=c[t],s=await chrome.tabs.group({tabIds:r[n]}),u=!r[n].includes(e.id),a=t%o.length;await chrome.tabGroups.update(s,{collapsed:u,title:n,color:o[a]})}})),r.addEventListener("click",(async()=>{const t=await chrome.tabs.query({currentWindow:!0,pinned:!1,url:["http://*/*","https://*/*"]}),e=Array();for(let r=0;r<t.length;r++)""!==t[r].groupId&&e.push(t[r].id);chrome.tabs.ungroup(e)}))})();